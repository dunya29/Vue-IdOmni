import{u as j,r as m,a as q,b as L,w as O,c as $,d as G,o as b,e as x,f as e,g as V,h as S,i as t,j as H,k as c,v as A,m as p,l as _,t as r,n as C,p as I,q as R,s as B,x as J,C as K,_ as Q,y as W,z as X,R as Y}from"./index-_u9tgNaj.js";const Z={class:"log-p"},ee={class:"container"},se={class:"log-p__inner"},te={class:"log-p__content"},oe={class:"log-p__top"},ae={class:"log-p__subtitle"},le={class:"form__items"},ie={class:"item-form"},re={"data-error":""},ne={class:"item-form"},de={"data-error":""},ue=["type"],me={"data-error":""},ce={class:"form__footer"},pe={class:"item-checkbox"},_e={"data-error":""},ve={key:0,class:"form__error","data-error":""},fe=["disabled"],be={__name:"RegPage",setup(ge){const E=j(),w=m(""),v=m(!1),n=m(!1),l=m(null),U={login:o=>o?!0:"Заполните поле",email:o=>o?W(o)?(w.value!=o&&(w.value=o,l.value=null),!0):(l.value=null,"Некорректный E-mail"):(l.value=null,"Заполните поле"),password:o=>o?X(o)?!0:"Пароль должен содержать минимум 6 символов":"Заполните поле",agree:o=>o===!0?!0:"Требуется согласие"},{errors:d,handleSubmit:M,isSubmitting:y,defineField:u}=q({validationSchema:U}),[f,N]=u("login"),[g,P]=u("email"),[i,T]=u("password"),[h,D]=u("agree"),z=G(),F=()=>{n.value=!n.value},k=M(async o=>{const s={email:o.email,login:o.login,password:o.password,userRole:"admin",emailVerified:!1,disable:!1};try{await L.createUser(s),E.logOut(),z.push("/verify")}catch(a){console.log(a),a.status===401&&(l.value="Пользователь с таким email уже существует")}});return O(()=>i.value,()=>{v.value=i.value.length>0}),(o,s)=>(b(),$(Q,null,{default:x(()=>[e("section",Z,[e("div",ee,[e("div",se,[e("div",te,[e("div",oe,[s[8]||(s[8]=e("h1",null,"Регистрация",-1)),e("p",ae,[s[7]||(s[7]=V(" Уже зарегистрированы? ")),S(t(Y),{to:{name:"login"},class:"link"},{default:x(()=>s[6]||(s[6]=[V("Войти")])),_:1})])]),e("form",{class:"form",onSubmit:s[5]||(s[5]=H((...a)=>t(k)&&t(k)(...a),["prevent"])),novalidate:""},[e("div",le,[e("div",ie,[c(e("input",p({type:"text",placeholder:"Логин","onUpdate:modelValue":s[0]||(s[0]=a=>_(f)?f.value=a:null)},t(N)),null,16),[[A,t(f)]]),e("div",re,r(t(d).login),1)]),e("div",ne,[c(e("input",p({type:"email",placeholder:"E-mail","onUpdate:modelValue":s[1]||(s[1]=a=>_(g)?g.value=a:null)},t(P)),null,16),[[A,t(g)]]),e("div",de,r(t(d).email),1)]),e("div",{class:C(["item-form item-form--password",{"show-eyeBtn":v.value,"show-password":n.value}])},[c(e("input",p({type:n.value?"text":"password",placeholder:"Пароль","onUpdate:modelValue":s[2]||(s[2]=a=>_(i)?i.value=a:null)},t(T),{autocomplete:"off"}),null,16,ue),[[I,t(i)]]),e("div",me,r(t(d).password),1),v.value?(b(),R("button",{key:0,type:"button",class:"btn-reset item-form__eye",onClick:s[3]||(s[3]=()=>F())})):B("",!0)],2)]),e("div",ce,[e("label",pe,[c(e("input",p({name:"agree",type:"checkbox",id:"result",class:"checkbox-input","onUpdate:modelValue":s[4]||(s[4]=a=>_(h)?h.value=a:null)},t(D)),null,16),[[J,t(h)]]),s[9]||(s[9]=e("span",null,"Даю согласие на обработку персональных данных",-1)),e("div",_e,r(t(d).agree),1)]),l.value?(b(),R("div",ve,r(l.value),1)):B("",!0),e("button",{class:"btn main-btn",type:"submit",disabled:t(y)},[e("span",{class:C(t(y)&&"loading")},"Зарегистрироваться",2)],8,fe)])],32),S(K)])])])])]),_:1}))}};export{be as default};
